# GoVerse Multi-Node Configuration with Per-Node Auto-Load Objects
#
# This configuration demonstrates:
# - Cluster-level auto-load objects (loaded on all nodes based on shard ownership)
# - Node-specific auto-load objects (loaded only on specific nodes)
#
# Use case: Different nodes might need different initialization objects
# For example, one node might be designated for matchmaking, another for leaderboards.
#
# See docs/config-design.md for full schema documentation.

version: 1

cluster:
  shards: 8192
  provider: "etcd"
  etcd:
    endpoints:
      - "localhost:2379"
    prefix: "/goverse/dev"
  
  # Cluster-level auto-load objects: created on all nodes based on shard ownership
  auto_load_objects:
    # Global singleton service - created on whichever node owns its shard
    - type: "GlobalMatchmaker"
      id: "MatchmakerService"
      per_shard: false
    
    # Per-shard service - one instance per shard, distributed across nodes
    - type: "ShardManager"
      id: "ShardMgr"
      per_shard: true

nodes:
  # Node 1: General purpose node with standard services
  - id: "node-1"
    grpc_addr: "127.0.0.1:50051"
    advertise_addr: "127.0.0.1:50051"
    http_addr: "127.0.0.1:8081"
    # Node-specific auto-load objects
    auto_load_objects:
      - type: "NodeMetricsCollector"
        id: "Node1Metrics"
      - type: "NodeHealthMonitor"
        id: "Node1Health"

  # Node 2: Specialized node for analytics and caching
  - id: "node-2"
    grpc_addr: "127.0.0.1:50052"
    advertise_addr: "127.0.0.1:50052"
    http_addr: "127.0.0.1:8082"
    # Different node-specific auto-load objects
    auto_load_objects:
      - type: "AnalyticsService"
        id: "Node2Analytics"
      - type: "CacheManager"
        id: "Node2Cache"
        per_shard: true  # One cache manager per shard on this node

gates: []

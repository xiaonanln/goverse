syntax = "proto3";

package chat;

option go_package = "github.com/xiaonanln/goverse/samples/chat/chat_pb";


message ChatMessage {
    string user_name = 1;
    string message = 2;
    int64 timestamp = 3; // Unix timestamp in microseconds
}


message Client_ListChatRoomsRequest {
}

// Response containing a list of available chat rooms
message Client_ListChatRoomsResponse {
    repeated string chat_rooms = 1;
}

message ChatRoom_ListRequest {
}

// Represents a chat message
message ChatRoom_ListResponse {
    repeated string chat_rooms = 1;
}

message Client_JoinChatRoomRequest {
    string room_name = 1;
    string user_name = 2;
}

message Client_JoinChatRoomResponse {
    string room_name = 1;
    repeated ChatMessage recent_messages = 2;
}

message Client_SendChatMessageRequest {
    string room_name = 1;
    string user_name = 2;
    string message = 3;
}

message Client_SendChatMessageResponse {
}

message ChatRoom_JoinRequest {
    string user_name = 1;
    string client_id = 2;  // Client ID for push notifications
}

message ChatRoom_JoinResponse {
    string room_name = 1;
    repeated ChatMessage recent_messages = 2;
}

message ChatRoom_SendChatMessageRequest {
    string user_name = 1;
    string message = 2;
}

message ChatRoom_SendChatMessageResponse {
}

// Message pushed to clients when a new chat message arrives
message Client_NewMessageNotification {
    ChatMessage message = 1;
}
